<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<link rel="stylesheet" href="dsk_sakura.css" type="text/css">
<TITLE>PPA/WSH専用マクロ関数</TITLE>
<META NAME="MS-HKWD" CONTENT="PPA/WSH専用マクロ関数">
<META NAME="MS-HKWD" CONTENT="GetFileName">
<META NAME="MS-HKWD" CONTENT="GetSelectedString">
<META NAME="MS-HKWD" CONTENT="ExpandParameter">
<META NAME="MS-HKWD" CONTENT="GetLineStr">
<META NAME="MS-HKWD" CONTENT="GetLineCount">
</HEAD>
<BODY>
<script type="text/javascript">
<!--
document.writeln('<OBJECT id="aaHHCtlCloseWin" type="application/x-oleobject"');
document.writeln(' classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"> ');
document.writeln(' <PARAM name="Command" value="Close"> ');
document.writeln('</OBJECT> ');

document.onkeypress=CheckClose;

function CheckClose() {
if (window.event.keyCode == 27)
aaHHCtlCloseWin.Click(); }
// -->
</script>
<h2>PPA/WSH専用マクロ関数/変数</h2>
キーマクロからは利用できない(しても意味がない)、関数があります。<br>
<br>
■関数宣言の書式<br>
function 関数名( 仮引数名 :変数型 ): 戻り値型;<br>
<br>
<img src="images/note.png">解説<br>
PPAから利用する場合、「<b>S_関数名</b>」と、S_をつけてください。<br>
WSHから利用する場合、「<b>Editor.関数名</b>」と、オブジェクト名をつけてください。<br>
<br>
C言語で書くと、以下のようになります。<br>
戻り値型 関数名( 変数型 仮引数名 );<br>
<br>
sakura: その関数が利用可能なバージョンを示します。<br>
<br>
■GetFileName<br>
function GetFileName(): String;<br>
<div class=li200>
・戻り値<br>
現在のファイル名が返ります。<br>
<br>
・解説<br>
取得できるファイル名はフルパスです。<br>
ファイル名が「(無題)」の場合は、空文字列が返ります。<br>
エラーにはなりません。<br>
</div><br>
(sakura:1.2.106.9以降)<br>
<br>
■GetSelectedString<br>
function GetSelectedString( int1 :Integer ) :String;<br>
<div class=li200>
・引数<br>
int1<br>
予約されています。0を指定してください。<br>
<br>
・戻り値<br>
選択されている文字列が返ります。<br>
<br>
・解説<br>
sakura:1.3.5.4以降 1.3.7.0まで<br>
1行の一部が選択されている場合 → 選択範囲<br>
2行以上選択されている場合 → 1行目の選択されている部分<br>
選択されていない場合 → キャレット位置の単語<br>
改行コード/NULL文字は文字列に含まれません。<br>
<br>
sakura:1.3.8.0以降<br>
選択部分全体を返します。未選択の時は空文字列を返します。<br>
改行コードなども含めて選択範囲の文字列をそのまま取得します。<br>
複数行の取得も可能です。<br>
従来の機能を使いたいときはExpandParameter("$s")を使ってください。<br>
</div><br>
sakura:1.3.5.4以降<br>
<br>
■ExpandParameter<br>
function ExpandParameter( str1 :String ): String;<br>
<div class=li200>
・引数<br>
str1<br>
展開したい、特殊文字列を指定します。<br>
<br>
・戻り値<br>
str1で指定した文字列が、展開・置き換えられた文字列が戻ります。<br>
<br>
・解説<br>
<a href="HLP000284.html">ExpandParameter</a>書式がそのまま使える関数です。<br>
</div><br>
<img src="images/hint.png">ヒント ExpandParameter( ’$F’ )； は S_GetFilename( )； と同じ値を返します。<br>
<br>
sakura:1.3.5.4以降<br>
<br>
■GetLineStr<br>
function GetLineStr( int1 :Integer ): String;<br>
<div class=li200>
・引数<br>
int1<br>
取得したい行の行番号を改行単位(1開始)で指定します。<br>
0を指定すると、カーソル行の文字列を取得できます。<br>
<br>
・戻り値<br>
改行コードを含む1行の文字列です。<br>
<br>
・解説<br>
取得する文字列も改行単位です。<br>
戻り値が、長さ0の文字列の場合、その行は存在しなかったことを意味します。<br>
int1がマイナス値だと、エラーが発生します。<br>
</div><br>
sakura:1.4.2.0以降<br>
<br>
■GetLineCount( int1 :Integer ) :Integer;<br>
<div class=li200>
・引数<br>
int1<br>
予約されています。0を指定しください。<br>
<br>
・戻り値<br>
改行単位の全行数を返します。<br>
最終行にデータがない場合、すなわちEOFだけの行は、この行数に含まれません。<br>
<br>
・解説<br>
int1に0以外を指定すると、エラーが発生します。<br>
EOFだけの行は、行数に含まれませんが、カーソルは移動できることに注意してください。<br>
</div><br>
sakura:1.4.2.0以降<br>
<br>
■ChangeTabWidth( int1 :Integer ) :Integer;<br>
<div class=li200>
・引数<br>
int1<br>
1〜64までの間の値が有効です。<br>
<br>
・戻り値<br>
設定変更前のタブ幅を返します。<br>
<br>
・解説<br>
引数で指定した値でタブ幅を設定します。<br>
タブ幅の取得のみ行いたいときは 0 など無効な引数を指定してください。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■IsTextSelected :Integer;<br>
<div class=li200>
・戻り値<br>
0  非選択状態<br>
1  選択中<br>
2  矩形選択中<br>
<br>
・解説<br>
選択幅が 0 のときも選択モードになっていれば選択中と判断します。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■GetSelectLineFrom :Integer;<br>
<div class=li200>
・戻り値<br>
選択開始行（1から始まる）を返します。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■GetSelectColmFrom :Integer;<br>
<div class=li200>
・戻り値<br>
選択開始桁（1から始まる）を返します。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■GetSelectLineTo :Integer;<br>
<div class=li200>
・戻り値<br>
選択終了行（1から始まる）を返します。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■GetSelectColmTo :Integer;<br>
<div class=li200>
・戻り値<br>
選択終了桁（1から始まる）を返します。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■IsInsMode :Integer;<br>
<div class=li200>
・戻り値<br>
0  上書きモード<br>
1  挿入モード<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■GetCharCode :Integer;<br>
<div class=li200>
・戻り値<br>
0  SJIS<br>
1  JIS<br>
2  EUC<br>
3  Unicode<br>
4  UTF-8<br>
5  UTF-7<br>
6  UnicodeBE<br>
<br>
・解説<br>
現在開いているファイルがどの文字コードとして開かれているかを調べます。<br>
特定範囲、または指定位置のテキストの状態を取得するものではありません。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■GetLineCode :Integer;<br>
<div class=li200>
・戻り値<br>
0  CRLF<br>
1  CR<br>
2  LF<br>
<br>
・解説<br>
『入力改行コードの指定』で指定された改行コードを調べます。<br>
特定範囲、または指定位置のテキストの状態を取得するものではありません。<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■IsPossibleUndo :Integer;<br>
<div class=li200>
・戻り値<br>
0  無効<br>
1  有効<br>
</div><br>
sakura:1.5.5.0以降<br>
<br>
■IsPossibleRedo :Integer;<br>
<div class=li200>
・戻り値<br>
0  無効<br>
1  有効<br>
</div><br>
sakura:1.5.5.0以降<br>
</BODY></HTML>
